Interactive Wormhole Detection in Large Scale Wireless Networks
Weichao Wang?
University of Kansas
Aidong Lu?
University of North Carolina at Charlotte
Abstract
Wormhole attacks in wireless networks can severely deteriorate the
network performance and compromise the security through spoil-
ing the routing protocols and weakening the security enhance-
ments. This paper develops an approach, Interactive Visualiza-
tion of Wormholes (IVoW), to monitor and detect such attacks in
large scale wireless networks in real time. We characterize the
topology features of a network under wormhole attacks through
the node position changes and visualize the information at dynami-
cally adjusted scales. We integrate an automatic detection algorithm
with appropriate user interactions to handle complicated scenarios
that include a large number of moving nodes and multiple worm-
hole attackers. Various visual forms have been adopted to assist
the understanding and analysis of the reconstructed network topol-
ogy and improve the detection accuracy. Extended simulation has
demonstrated that the proposed approach can effectively locate the
fake neighbor connections without introducing many false alarms.
IVoW does not require the wireless nodes to be equipped with any
special hardware, thus avoiding any additional cost. The proposed
approach demonstrates that interactive visualization can be success-
fully combined with network security mechanisms to greatly im-
prove the intrusion detection capabilities.
Keywords: Interactive Detection, Wormhole Attacks, Visualiza-
tion on Network Security, Wireless Networks, Topology Visualiza-
tion
Index Terms: C.2.0 [Computer-Communication Networks]:
General—Security and protection; H.5.2 [Information Systems]:
Information Interfaces and Presentation—User interfaces;
1 Introduction
Intrusion Detection System (IDS) in wireless networks [42] has
played an important role in network security by providing an ad-
ditional level of protection to the network topology and applica-
tions beyond the traditional security mechanisms such as encryp-
tion and authentication. It detects the attacks and isolates the ma-
licious nodes by matching the patterns of known intrusions or dis-
covering the anomalies [5, 12, 13, 16] in the network activities. Its
application environments cover almost all wireless networking sce-
narios such as ad hoc networks [42], wireless LANs [8], and sensor
networks [5, 12]. A good survey can be found in [43].
With the fast increases in the scale, available bandwidth, and pro-
tocol diversity in wireless networks, the intrusion detection mecha-
nisms must discover the patterns of the known attacks or the anom-
alies caused by the unknown intrusions from a continuous, multi-
variate data flow in real time. Therefore, effective representation
of the data is essential for users to understand the hidden informa-
tion and for IDS to preserve the detection accuracy and efficiency.
Visualization techniques, which enable the derivation of insights
from massive and dynamic data, provide a powerful tool to satisfy
these requirements. In addition to information representation, the
?e-mail: weichaow@eecs.ku.edu
†e-mail: alu1@uncc.edu
Figure 1: Visualization for wormhole detection. The two red circles
indicate suspicious regions. We have combined interactive visual-
ization into the wormhole monitoring, representation, and detection
processes to analyze the potential wormhole attack regions in a large
scale wireless network.
visualization techniques also provide highly interactive interfaces
to accelerate visual analytics. There has been pioneer research on
visualization for computer security. The adopted methods include
multiresolution of the data details [2], visual correlation among dif-
ferent parts of the data [14, 35], and time-varying patterns [15, 28].
Most of the existing IDS approaches depend on the measure-
ments of some network parameters (e.g. packet delivery ratio, end
to end delay) to identify the attacks. Therefore, the detection ca-
pabilities will be restricted by the acquiring delay and accuracy of
these measurements. Since many attacks on wireless networks tar-
get at the network topology (e.g. neighbor discovery and routing),
new approaches are expected to detect such attacks based on more
direct “evidences”.
In this paper, we explore the development of approaches that can
detect attacks on wireless networks directly based on their impacts
on the network topology. To demonstrate the proposed method, we
choose a specific attack, wormhole attack [10, 18, 30], as the re-
search problem. In a wormhole attack, the malicious nodes will
tunnel the eavesdropped packets to a remote position in the net-
work and retransmit them to generate fake neighbor connections,
thus spoiling the routing protocols and weakening some security en-
hancements. The impacts of wormhole attacks on the reconstructed
topology of a 2D wireless network are illustrated in Figure 1. The
simulation results in [17, 21] have shown that when there are more
than two wormholes in the network, more than 50% of the data
packets will be attracted to the fake neighbor connections and get
discarded.
A preliminary approach, MDS-VoW, to wormhole detection us-
ing visualization techniques was proposed by Wang and Bhargava
in [39]. The approach uses multidimensional scaling (MDS) to
reconstruct the topology of a wireless network and locates the
wormholes and fake neighbor connections by identifying the dis-
tortions in the reconstruction result. Although effective as a proof-
of-concept prototype, MDS-VoW has several deficiencies when it is
applied to real wireless environments. First, the authors only eval-
uate MDS-VoW in a network containing a few hundreds of nodes.
Its performance and accuracy in a larger scale environment (e.g.
thousands of nodes) remain undetermined. Second, MDS-VoW as-
sumes that all nodes are static. Therefore, its detection capability
in mobile wireless networks has not been investigated. Finally, the
experimental results focus on the scenarios when only one worm-
hole exists in the network while the research in [17, 21] has demon-
strated that multiple wormholes put more severe impacts on the net-
work performance.
The method introduced in this paper, Interactive Visualization
of Wormhole (IVoW), provides a visual approach through which
the users can detect multiple wormholes in a large scale, dynamic
wireless network. It first reconstructs the network topology based
on the measured distances among neighboring nodes. To reduce the
network reconstruction overhead caused by node movement, incre-
mental multidimensional scaling [4, 40] is adopted. Adaptable rep-
resentation of the reconstruction result with attack-dependent level-
of-detail will assist the users to identify the “suspicious areas” un-
der wormhole attack. Multiple rounds of detection with false-alarm
reduction methods will help improve the detection accuracy when
multiple wormholes coexist in the system.
As we will demonstrate, the proposed visualization approach can
effectively identify the fake neighbor connections. The contribu-
tions of the research can be summarized as follows: (1) We charac-
terize the topology features of the network under wormhole attacks
and present a real time visualization approach to effectively visu-
alize and monitor topology changes. (2) We integrate interactive
visualization into multiple steps of intrusion detection procedures,
including monitoring, detection, and representation. This approach
significantly accelerates the detection procedure by taking advan-
tage of the visual analysis abilities of human expertise. (3) IVoW
directly uses the topology information to detect attacks on wire-
less networks, thus avoiding the overhead and inaccuracy caused
by the network measurements. (4) The proposed approach does
not depend on any special hardware, thus avoiding any additional
deployment cost.
The remainder of the paper is organized as follows: Section 2
provides the background of wireless networking, how wormhole at-
tacks are conducted, and the research challenges. Section 3 reviews
the previous research efforts that contribute to our approach. In
section 4, an overview of IVoW is described. Three principal com-
ponents of the proposed mechanism, efficient network reconstruc-
tion, adaptive visualization, and interactive wormhole detection, are
described in detail in section 5, 6, and 7, respectively. Section 8
presents the experimental results. Finally, section 9 concludes the
paper and discusses future extensions.
2 Background
In a wireless network, the nodes communicate with each other
through radio transmissions. A simplified model to describe the
connectivity among wireless nodes is the unit disk graph [9]: a
pair of nodes u and v can directly communicate to each other if
the Euclidean distance between them is shorter than r, where r is
defined as the communication range. Since the neighbor relations
among wireless nodes may change because of various reasons such
as node movement, device malfunction, battery exhaustion, and un-
reliable transmission medium, a node must be able to detect its ac-
tive neighbors dynamically. A widely adopted approach is to let the
mobile node periodically broadcast a short message containing its
identity (called ‘beacon’ packet) and the neighbors receiving this
packet will add the node into the neighbor lists. The awareness of
localized network topology and route choices are usually based on
the correct establishment of and updates to the neighbor list.
The features of wireless communication enable the malicious
nodes to conduct wormhole attacks. As shown in Figure 2, when a
u 1
u
u 2
u
u
13
4
3v
v
v
v 2
1M
M 2
Wormhole Tunnel
Figure 2: Wormhole attack between a pair of nodes u and v.
legitimate node u in the network sends out a beacon, the malicious
node M1 can use its antenna to eavesdrop the packet, and tunnel it
through a dedicated long range channel to its colluder M2. When
M2 retransmits the beacon, another legitimate node v will receive
this packet and add u into its neighbor list. Fake neighbor connec-
tions are generated through wormholes. Later when data packets
need to go through the wormhole, the malicious nodes may choose
to discard them. Therefore, a wormhole fabricates a fake connec-
tion between u and v that is under the control of the attackers.
Wormhole attacks are difficult to detect since the malicious
nodes only eavesdrop and retransmit the beacons. The adoption
of a stronger encryption or authentication method will not solve the
problem since the attackers act as the clone of the legitimate nodes.
At the same time, the fake “short” path between u and v may at-
tract many data packets from their neighborhood, thus deteriorating
the delivery ratio and network performance. Therefore, new ap-
proaches must be developed to stop these attacks.
3 Related Work
3.1 MDS and Its Applications in Wireless Networks
Multi-dimensional scaling was originally a technique developed
in the behavioral and social science for studying the relationship
among objects. The inputs to MDS are the measures of the differ-
ence or similarity between object pairs [11]. The output of MDS is
a layout of the objects in a low-dimensional space. In this paper, the
input is the distance matrix between the wireless nodes. The mech-
anism can reconstruct the network and calculate a virtual position
for every node. We adopt the classical metric MDS in the proposed
mechanism since the distances are measured in a Euclidean space.
More details of MDS can be found in [11] and [38].
MDS has been adopted to solve the localization and positioning
problems in wireless networks. In [37], a solution using classical
metric MDS is proposed to achieve localization from mere connec-
tivity information. The algorithm is more robust to measurement
errors and requires fewer anchor nodes than previous approaches.
A distributed mechanism for sensor positioning using MDS has
been presented in [19]. It develops a multi-variate optimization-
based iterative algorithm to calculate the positions of the sensors.
Another approach [6] to sensor network localization adopts semi-
definite programming relaxation to minimize the errors for fitting
the distance measurements.
3.2 Wormhole Detection in Wireless Networks
Wormhole attacks on mobile wireless networks were independently
discovered in [10], [18], and [30]. Below we describe several ap-
proaches that have been developed to defend against such attacks.
If the wireless nodes are equipped with directional antennas [17],
a pair of nodes can examine the directions of the received signals
from each other and a shared third node to confirm the neighbor re-
lation. In [18], extra information is added into a packet to restrict its
transmission distance. In geographical leashes, the location infor-
mation and loosely synchronized clocks together verify the neigh-
bor relation. In temporal leashes, the packet transmission distance
is calculated based on the propagation delay and signal transmis-
sion speed. In addition to the approach using scientific visualization
[39], a wormhole prevention mechanism based on graph theory is
proposed in [31]. Using the geometric random graphs induced by
the communication range constraint of the nodes, the researchers
present the necessary and sufficient conditions for detecting and
defending against wormholes. They also present a defense mecha-
nism based on local broadcast keys.
3.3 Distance Estimation between Wireless Nodes
Since MDS uses the measured distances among wireless nodes that
can hear each other as inputs to reconstruct the network, we shortly
introduce several distance estimation methods. The existing solu-
tions include using received signal strength [22], Time-of-Arrival
and Time Difference of Arrival [32, 36], and triangulation [29].
One point that we have to clarify is that the measured distances
cannot be directly used to prevent wormholes. For example, if the
received signal strength is used to estimate the distance, the receiver
cannot distinguish the resent packet from the real beacon. Similarly,
if the nodes use the propagation delay of acoustic signals to measure
the distance, the malicious nodes can easily hide the tunneling delay
if radio transmission is used in the wormhole.
3.4 Visualization for Computer Security
With the fast development of computer security mechanisms, the
scale and complexity of the security data put ever-increasing chal-
lenges to the representation and understanding of the information.
Visualization techniques have been adopted by the researchers to
bridge the gap. For example, it is usually difficult for the system
administrators to read a text-based log file recording the traffic pat-
terns and anomalies that happened in the past twenty-four hours.
The researchers have developed mechanisms that can provide an
overview of the traffic patterns of thousands of hosts [3]. The lat-
est approaches provide a more scalable representation capability
that can cover multiple class-B IP address ranges and the intrusion
alarms in them [2, 20, 23].
Network scans are probably the most common and versatile in-
trusions. Researchers have developed a visualization methodol-
ogy to characterize the scans based on their patterns and wavelet
scalograms [28]. Another approach uses IP address and port
number histographs to detect and analyze the scan attacks [35].
VisFlowConnect-IP [41] achieves detection of anomalous traffic
through a link-based network flow visualization tool.
Under many conditions, the security data acquired from different
methods must be investigated jointly to improve the detection ac-
curacy and efficiency. The research efforts in [14] provide a visual
correlation between the host processes and network traffic. In both
[28] and [35], the approaches can identify the similarity among dif-
ferent scan attacks or NetFlow signatures.
While many visualization approaches to network security require
large amounts of finely detailed, high-dimensional data, several
mechanisms focus on the big picture. For example, the mechanism
in [25] takes very coarsely detailed data to help uncover interesting
security events. The mechanism in [33] overcomes the scalability
issues inherent in visualizing massive networks through sampling.
In [15], low level textual data are provided in the context of a high-
level, aggregated graphical display. Disparate logs are also visual-
ized to show the correlation of network alerts based on what, when,
and where [24].
4 Overview
An overview of IVoW is illustrated in Figure 3. After deployment,
a wireless node will estimate the distances to the other nodes that
it can hear and send the measurement results to IVoW. Some fake
neighbor connections through wormholes may be included. En-
cryption and authentication methods can be adopted to protect the
integrity of the information and prevent impersonation.
Figure 3: System overview: A distance matrix (a) acquired from a
large scale wireless network is used to reconstruct the 3D positions of
the nodes using incremental MDS method (b), and modified through
our feature point sampling (c), feature line selection (d), primitive
assignments (d), and interactive detection (e) to defend against the
wormhole attacks (f).
The proposed approach will use the measurements to build the
distance matrix and reconstruct the network topology using incre-
mental MDS. A normalized wormhole indicator value will be cal-
culated for every node to identify those “suspicious areas” under
wormhole attack (section 5).
When the scale of the network and number of nodes are consid-
ered, the user may be overwhelmed by the information in the visu-
alization. We integrate the feature element selection and attribute
assignment methods to develop an adaptive visualization method.
Only a part of carefully chosen nodes and their neighbor relations
are illustrated while the network topology is preserved so that the
suspicious areas under attack can be easily located (section 6).
The proposed mechanism takes advantage of the expertise of the
users to accelerate the wormhole detection procedure and improve
the accuracy. A set of interaction interfaces are designed to allow
the users to identify the suspicious areas and activate more com-
plicated detection methods. Therefore, interactive visualization not
only helps improve information understanding but also assists prob-
lem solving through visual analysis (section 7).
5 Efficient Network Reconstruction
5.1 Fast Network Reconstruction
The proposed mechanism uses MDS to reconstruct the network lay-
out. First, every pair of nodes that can hear each other will estimate
the distance between them and report it to IVoW. The mechanism
will calculate the average value and put the result at the suitable
positions in the distance matrix. After that, a classical shortest-path
algorithm, such as Dijkstra’s algorithm, can be used to calculate the
shortest distance between every node pair. Using the distance ma-
trix, MDS can rebuild the network and a virtual position for every
node will be generated.
The computation complexity of traditional MDS is n3 when there
are n nodes in the network. If IVoW reconstructs the whole network
from scratch after every neighbor relation change, the computation
overhead will become overwhelming when n is large, thus impact-
ing the scalability and efficiency of the proposed mechanism. To
achieve efficient network reconstruction, we propose to adopt the
incremental MDS proposed in [4, 7, 26, 40].
The fast network reconstruction method is based on [7, 26],
whose computation complexity is n2. Since the distances among
wireless nodes seldom experience radical changes, the reconstruc-
tion result of the previous round is a good initial layout of the nodes.
Single scaling will then be executed for the nodes whose neighbor
relations change. The final step runs several MDS iterations upon
the entire node set to refine their positions. An example of incre-
mental MDS is illustrated in Figure 4.
Figure 4: Example of incremental MDS: a pair of nodes slowly move
to each other, thus leading to changes in network topology.
5.2 Estimating Wormhole Indicator Value for Wireless
Nodes
The analysis in [39] has shown that the wormholes can be viewed
as an extra force that will lead to the distortions: the distances and
angles among the neighboring nodes in the reconstructed network
will be very different from the values in the real layout. Subsequent
research [21] has shown that the distortions in angles can be used
to locate the fake neighbor connections.
For every angle formed by three neighboring nodes u1, u2, and
v with v as the vertex, two values can be determined: (1) ?M?u1vu2 ,
which can be calculated based on the measured distances among
them; (2) ?R?u1vu2 , which can be acquired from the reconstructed
network. The distortions in angles can be measured by the differ-
ence between these two values.
We define a new variable wormhole indicator (wi) for every
node v based on the differences in angles:
wormhole indicator(v) =
??di f f?uivu j
q(q?1) ;(i, j = 1 · · ·q, i 6= j)
?di f f?uivu j =
{
0, i f ||?M?uivu j ??R?uivu j || ? ?th;
1, i f ||?M?uivu j ??R?uivu j ||> ?th. (1)
where v, ui and u j are neighbors, and q is the degree of connectiv-
ity of v. From the definition we find that wormhole indicator is a
normalized variable with the value range [0,1].
?th in equation 1 represents the threshold that is used to distin-
guish the changes in angles caused by the distance measurement in-
accuracy from the distortions caused by the wormholes. We adopt
a format of c · derr0.5r for ?th, in which derr represents the distance
measurement inaccuracy, r is the communication range, and c is a
constant. When the distance estimation errors are not large, derr0.5r
roughly describes the change in angles caused by the inaccuracy.
Our simulation shows that a value not smaller than 4 should be as-
signed to c to preserve the detection accuracy.
While the wormhole indicator values measure the impacts of the
wormholes within a single network reconstruction, we also take the
time factor into consideration by monitoring the distance changes
among the node pairs in different reconstructions. If a pair of nodes
were far away from each other in the previous reconstruction and
suddenly become neighbors, the link between them will be exam-
ined carefully to prevent wormholes.
6 Adaptive Network Visualization
With the reconstructed topology and initial wormhole indicator val-
ues, we can visualize a wireless network to monitor and detect
wormhole attacks. In this section, we describe our feature element
selection and attribute assignment methods to effectively visualize
a large scale wireless network.
Intuitively, we use points to represent wireless nodes, lines to
strengthen the network topology, and rendering settings to reveal
the intrusion detection information. This point-and-line based vi-
sualization method is developed to satisfy the real-time rendering
requirement and to provide an effective framework for illustrating
network topology and security information.
Choosing a suitable resolution is one major problem for visual-
izing a large scale network topology. It is difficult to observe any
abnormality when there are a large number of points and lines over-
lapping on the screen. Multiple rendering resolutions can be used
to alleviate this problem. However, it is not practical for users to
adjust the suitable resolution manually, since the interaction would
be too tedious for a real-time network monitoring task. Therefore,
we propose to develop a self-adapted visualization method to auto-
matically select sample points and lines.
6.1 Feature Points Selection
We select feature points based on their wormhole indicator values
and location information to reduce the overlapping issue and pre-
serve major topology features. Next, we discuss our ideal point
distance measurement based on wormhole indicator values, the lo-
cation information calculation, and our feature point selection pro-
cedure.
Since the wormhole indicator is one significant feature for moni-
toring and detecting network attacks, we use this value to adjust the
ideal point distance for each node. We draw all the points whose
indicator values are larger than the threshold ?wi, which is defined
in the previous work [39] and can be adjusted by users, and keep a
large point distance Dl for points with low indicator values. This
results in a low point density on smoother surfaces and more de-
tailed changes for abnormal regions. Practically, we use 5% of the
rendering space width as Dl .
dis(v) =
{
Dl × (1?
wi(v)
?wi ), i f wi(v) < ?wi
0, i f wi(v)? ?wi
(2)
We also include the location information in the selection proce-
dure for preserving the network topology shape, including a bound-
ary indicator and a surface roughness measurement. We adopt the
approach proposed by Rao et al. [34] to identify the boundary
nodes of the network and assign their boundary indicators to ‘1’.
We intend to select these points since they are important to rep-
resent the shape of the entire network. For each node v in the
reconstructed topology, its normal direction ??v can be calculated
using the best fitted plane within a local region [39]. If the set of
neighbors of v is represented as Nv, the surface roughness value
can be calculated using the average normal direction changes, as
rough(v) = ?u?Nv
(1???v ·??u )
2q , where q is the number of neighbors
in Nv. We intend to keep higher point density for rough surfaces,
since they are more likely to contain abnormal information.
The feature value of a node is calculated as the weighted sum
of the three factors: wormhole indicator, boundary indicator, and
roughness value. We keep the sum of the weights wwi +wb +wr =
1 for saving the normalization process and we use 0.5, 0.3, 0.2
for wwi, wb and wr respectively, favoring the wormhole indicator
values.
Feature(v) = wwi ·wi(v)+wb ·bound(v)+wr · rough(v) (3)
Figure 5: Point density is reduced to a smaller scale for clarity through
feature point selection.
The procedure to select feature points can be viewed as choos-
ing a point subset that approximates the ideal point distances and
achieves the maximum feature sum value. Since a greedy algorithm
produces very similar results in representing the topology informa-
tion, we adopt a fast algorithm by using the following selecting and
updating phases.
A node with the maximum feature value is first selected through
traversing the point list and added to the feature point set. Then, we
update feature values of all the local points by a factor according
to the distance d to the selected point using Feature(v) = f (v)×
Feature(v), where
f (v) =
{ 1, i f d ? dis(v)
( ddis(v) )
2, i f d < dis(v) (4)
We repeat this process until all the remaining points have been mod-
ified at least by a factor of f ( dis(v)2 ). This ensures the completeness
of the network topology.
We can further accelerate this selection process by selecting mul-
tiple points at each time. For the points whose feature values are
larger than ?wi/2, we randomly select multiple points into the fea-
ture set. We can also directly use the point distance from the origi-
nal distance matrix in section 5 to accelerate this process. As shown
in Figure 5, the point density is reduced to a smaller scale for clarity.
6.2 Feature Lines Selection
We use feature lines to further strengthen the topology information
by connecting selected feature point pairs. Since a wireless net-
work usually forms a highly connected topology, we cannot illus-
trate every neighbor pair because of the intersecting issue. Instead,
we select a small number of lines that can be used to enhance the
major topology features.
To generate a succint line drawing, we summarize three criteria
for selecting feature lines.
• Intersection: Any two lines should not intersect on a smooth
surface.
• Connectivity: At least one line is connected to each feature
point.
• Cell areas: Small areas composed by the surrounding lines
should be avoided for better representation.
Under these three criteria, we choose feature lines by using De-
launay triangulation algorithm [27]. Our first two criteria are satis-
fied automatically and the third criterion can be approximated from
the Delaunay triangulation, since it maximizes the minimum angle
of all the triangles. The result of 3D Delaunay triangulation method
is used to select the feature lines between the corresponding point
pairs. As shown in Figure 6, the selected feature lines enhance the
main surface information in the network topology.
6.3 Attributes Assignment
To effectively visualize the network features, we assign the render-
ing attributes, including size, color, and transparency, for the se-
lected feature points and lines according to the wireless node prop-
erties.
Figure 6: The automatically selected feature lines can significantly
enhance the visualized network topology.
Figure 7: The primitive attributes are adjusted for effectively visualiz-
ing the node properties. Red color suggests potential attack regions.
The point size is adjusted to represent the local point density.
Since the feature point selection process changes the original point
density, we use the ideal feature point distance to approximate real
point density, which is decided from the wormhole indicator value.
Here maxsize represents the maximum point size in the rendering
and we use 10 in our system.
size(v) =
{
1+maxsize× (1? wi(v)?wi ), i f wi(v) < ?wi
1, i f wi(v)? ?wi
(5)
Therefore, larger points represent smoother surfaces in the visual-
ization; while smaller points indicate more abrupt changes in the
topology.
The point color is assigned from blue to red to reveal the worm-
hole indicator value from low to high.
color(v) = wi(v)?Cred +(1?wi(v))?Cblue (6)
The point transparency is also calculated from its indicator as
wi(v)pt , since the users are most interested in the potential attacked
regions. Pt is set as 1.5 in our implementation. The transparent
points also allow the users to see through a complex topology, as
shown in Figure 7.
The line attributes are simply adjusted according to the attributes
of the neighbor points, since we mainly use their positions to sug-
gest the network topology. Their color and transparency are inter-
polated linearly between the two connecting points. We use the
same thin line width to render all the lines for the least overlapping.
7 Interactive Wormhole Detection
We propose to integrate interactive visualization with intrusion de-
tection algorithms to accelerate the detection process and improve
the algorithm accuracy. Our previous work achieves a high suc-
cess ratio at detecting wormhole attacks in an experimental environ-
ment. Problems occur when we apply the mechanism to networks
at a larger scale. As shown in Figure 11 (a), the detection accuracy
can decrease drastically with an increasing environment complexity
caused by multiple attackers. Therefore, we develop an interactive
visualization system to handle these large, complex wireless en-
vironments. The following describes our interface design and an
interactive detection procedure for wormhole detections.
Figure 8: Our wormhole detection interface. The left top locates the
history window, left bottom includes parameter window and topology
interaction window, and the right lists the identities and information
of the potential attackers.
7.1 Interface Design
We combine the tasks of monitoring and detecting wormhole at-
tacks into one unique system interface. Our basic idea is to visual-
ize the network topology and potential attacks in a manner that is
convenient for users to associate all the relevant information.
As shown in Figure 8, our interface is composed of three win-
dows: topology window (bottom middle), target window (right),
and history window (top left). The topology window visualizes
the current network topology, where users can interact with the
topology with several routine tasks, including zooming, rotating,
and selecting region-of-interest. The target window lists the nodes
whose wormhole indicator values are larger than the threshold ?wi.
We also collect the information of each node for analysis, such
as neighbor relationships, traffic history, etc. On the top left, we
arrange a history window that illustrates the network topologies of
the previous several time steps for observing the topology changes.
7.2 Interactive Detection
To handle a large, complex network environment, we need to inte-
grate user interaction with our wormhole detection and visualiza-
tion methods. Our approach is to use the user inputs to guide the
automatic detection procedure for further analysis. This allows the
users to achieve a high success ratio with only a limited amount of
simple interactions.
During the detection, the users are only required to draw a cube
roughly around their region-of-interest. This cube is located by the
left, back, top corner and the right, front, bottom corner. These two
3D points can be specified through the combined inputs of mouse
movement and hot keys. Generally, only several operations are re-
quired to achieve a satisfying detection result.
Once the region-of-interest is located, the system will automati-
cally process the interaction information, provide detailed analysis
results, and use this information to update the network topology
for further detection. Let us define the nodes within the region-
of-interest as candidate nodes. Since these user selected candidate
nodes may indicate the existence of wormholes, we propose a pro-
gressive procedure to analyze them automatically.
First, we reconstruct the network topology without all the candi-
date nodes and calculate the stress value s1 of MDS.
Second, we sort all the candidate nodes in a decreasing order
based on their numbers of neighbors. A node with the maximum
neighbor number will be added back into the network and we use
incremental MDS to fast reconstruct a new topology, which pro-
duces the stress value s2.
Third, the change between the current and previous topologies
is measured by using their stress values as s2?s1s1 . If the change is
below a threshold (10%), the candidate point is viewed as a “good”
node, will be added back to the network, and we go back to step
2. Otherwise, at least one of its neighbor connections belongs to a
wormhole. We continue to step 4.
Fourth, since all the neighbor connections of the candidate point
are independent, we reconstruct the network topology using incre-
mental MDS by adding each neighbor line back and compare the
topology change from the previous step. For each line causing the
stress value to increase beyond the threshold, a warning packet will
be sent to both nodes connected by this line to indicate that this is a
false connection and should be removed immediately.
Figure 9 illustrates our detection procedure, which successfully
analyzes and identifies all the attacked regions in a distorted net-
work topology. Only several simple user interactions are involved
in handling complex wormhole attacks.
8 Experimental Results
The detection accuracy of the proposed mechanism is evaluated
through simulation. We use the network simulator ns2 [1], which is
widely adopted by the wireless networking investigators. To enable
the comparison between IVoW and MDS-VoW and demonstrate the
improvements, we adopt a relatively small scale wireless network.
We assume that 600 nodes are randomly and roughly uniformly
deployed in a square area with the size of 2km×2km. The commu-
nication range among wireless nodes is r = 180m and the average
degree of connectivity is 10.35.
The same network topology and wormhole attack scenarios are
provided to both mechanisms. The detection accuracy is measured
by the false alarm rate. Two parameters are of special interest: the
fraction of detected wormholes, and the number of real neighbor
connections that are wrongly labeled as wormholes. Every data
point in the following figures represents the average value over 15
trials under different network setups.
8.1 Robustness against Distance Estimation Errors
Since the network reconstruction is conducted based on the mea-
sured distances among wireless nodes, the measurement accuracy
has a direct impact on the detection capability. In our simulation,
we model the distance estimation errors as uniform noises. If the
accurate distance between two nodes is d (d ? r) and the error
rate is em, a random value drawn from the uniform distribution
[d× (1? em), min(r, d× (1 + em))] will be used as the measured
distance. We examine different values of em from 0 to 80%. We as-
sume that one wormhole exists in the network and the victims of the
attack are randomly selected. The simulation results are illustrated
in Figure 10.
The results show that IVoW greatly improves the detection ac-
curacy when the distance estimation errors are relatively large. The
improvements are primarily realized through the user interactions.
They take advantage of the expertise and judgements of the user
to drastically reduce the size of the suspicious area so that a more
complicated detection method described in section 7.2 can be ap-
plied to a localized network.
8.2 Detection Accuracy under Multiple Wormholes
One of the advantages of IVoW is that it can detect the fake neigh-
bor connections when there are multiple wormholes in the network.
In the second group of experiments, we fix the value of em at 40%
and examine the detection accuracy of the proposed mechanism
when the number of wormholes changes. The victims of the attacks
are randomly and independently selected as long as the distance be-
tween the two ends of a wormhole is longer than the communication
range. The results are illustrated in Figure 11.
The improvements are more obvious in this group of experi-
ments. Through the user interactions, the detection procedure can
Figure 9: The interactive wormhole detection procedure is shown
from top to bottom with two views for each user input and the
consequent detection result. A user simply draws a transparent red
cube around a potential attack region and a progressive algorithm is
performed to analyze the details.
 40
 60
 80
 100
 10  20  30  40  50  60  70  80 0
Distance estimation error rate em (%)
D
et
ec
te
d 
w
or
m
ho
le
s (
%
)
MDS?VoW
IVoW
(a) improvements in detection accuracy of IVoW (compared to MDS-VoW)
 0
 1
 2
 3
 4
 5
 0  10  20  30  40  50  60  70  80
Distance estimation error rate em (%)
w
ro
ng
ly
 la
be
le
d 
as
 w
or
m
ho
le
s (
%
)
Pe
rc
en
ta
ge
 o
f r
ea
l c
on
ne
ct
io
ns
with wormhole, MDS?VoW
with wormhole, IVoW
without wormhole, MDS?VoW
without wormhole, IVoW
(b) reduction in false positive alarms of IVoW (compared to MDS-VoW)
Figure 10: Detection accuracy of IVoW under different distance es-
timation error rates.
locate the suspicious areas more accurately and the impacts of mul-
tiple wormholes on the detection accuracy are reduced. From the
results in Figure 10 and 11, we find that the user interactions can
improve both the wormhole detection efficiency and accuracy, and
the proposed mechanism is robust against the distance estimation
errors and multiple wormholes.
9 Conclusions and Future Work
In this paper, we propose an approach that integrates visual rep-
resentation, user interaction, and automatic analysis algorithms to
defend against wormhole attacks in wireless networks. Through in-
tegrating interactive visualization into multiple steps of IVoW in-
cluding representation, monitoring, and detection, we show that
visualization can not only be used to improve information under-
standing, but also be combined with domain knowledge and user
expertise to solve problems through visual analysis.
While the detection of one kind of attack is investigated in depth,
the basic ideas presented here can be extended to deal with other
aspects of network security. For example, the anomalies in the lo-
calized neighbor relations caused by the fake identities can be used
to detect Sybil attacks. If the reconstructed network topology is
monitored together with the traffic flows, the black holes of data
transmission in wireless networks can be located. The visualization
techniques and interaction interfaces enable the users to analyze and
manage the networks with an ever-increasing scale and complexity.
Furthermore, directly applying the network topology information
to attack detection avoids the overhead and inaccuracy caused by
the parameter measurement procedures.
To better evaluate the proposed approach, we will investigate its
detection accuracy by applying it to real large scale wireless net-
work environments such as underwater sensor networks, in which
the nodes can move freely in 3D spaces. We plan to investigate vi-
sualization of other attacks based on the connectivity information
among wireless nodes. A more generic attack detection framework
integrating visualization and interaction techniques will be devel-
oped to enforce wireless network security.
References
[1] IEC Workshop on Internet Simulations with the NS simulator, 2000.
 40
 60
 80
 100
 0  1  2  3  4  5
Number of wormholes in the network
D
et
ec
te
d 
w
or
m
ho
le
s (
%
)
MDS?VoW
IVoW
(a) improvements in detection accuracy of IVoW (compared to MDS-VoW)
 0
 1
 2
 3
 4
 5
 6
 7
 8
 0  1  2  3  4  5
Number of wormholes in the network
Pe
rc
en
ta
ge
 o
f r
ea
l c
on
ne
ct
io
ns
w
ro
ng
ly
 la
be
le
d 
as
 w
or
m
ho
le
s (
%
)
MDS?VoW
IVoW
(b) reduction in false positive alarms of IVoW (compared to MDS-VoW)
Figure 11: Detection accuracy of IVoW when the number of worm-
holes increases.
[2] K. Abdullah, C. Lee, G. Conti, J. Copeland, and J. Stasko. IDS rain-
storm: Visualizing IDS alarms. In Proc. of VizSEC, 2005.
[3] R. Ball, G. Fink, A. Rathi, S. Shah, and C. North. Home-centric vi-
sualization of network traffic for security administration. In Proc. of
ACM VizSEC/DMSEC, 2004.
[4] W. Basalaj. Incremental multidimensional scaling method for data-
base visualization. In Visual Data Exploration and Analysis VI (Proc.
SPIE, volume 3643), 1999.
[5] V. Bhuse and A. Gupta. Anomaly intrusion detection in wireless sen-
sor networks. Journal of High Speed Networks, 1(15), 2006.
[6] P. Biswas and Y. Ye. Semidefinite programming for ad hoc wireless
sensor network localization. In Proc. of ACM/IEEE IPSN, 2004.
[7] M. Chalmers. A linear iteration time layout algorithm for visualizing
high dimensional data. In Proc. IEEE Visualization, pages 127–132,
1996.
[8] M. Chirumamilla and B. Ramamurthy. Agent based intrusion detec-
tion and response system for wireless LANs. In Proc. of IEEE Inter-
national Conference on Communications, pages 492–496, 2003.
[9] B. Clark, C. Colbourn, and D. Johnson. Unit disk graphs. Discrete
Mathematics, 86(1–3):165–177, 1990.
[10] B. Dahill, B. Levine, E. Royer, and C. Shields. A secure routing pro-
tocol for ad hoc networks. University of Massachusetts, Tech Report
CS-02-32, 2001.
[11] M. Davison. Multidimensional Scaling. John Wiley and Sons, 1983.
[12] W. Du, L. Fang, and P. Ning. LAD: Localization anomaly detection
for wireless sensor networks. In Proc. of International Parallel and
Distributed Processing Symposium, 2005.
[13] W. Fan, M. Miller, S. Stolfo, W. Lee, and P. Chan. Using artificial
anomalies to detect unknown and known network intrusions. Knowl-
edge and Information Systems, 6(5), 2004.
[14] G. Fink, P. Muessig, and C. North. Visual correlation of host processes
and traffic. In Proc. of VizSEC, 2005.
[15] J. Goodall, P. Rheingans, W. Lutters, and A. Komlodi. Preserving the
big picture: Visual network traffic analysis with TNV. In Proc. of
VizSEC, 2005.
[16] J. Hall, M. Barbeau, and E. Kranakis. Using mobility profiles for
anomaly based intrusion detection in mobile networks. In Proc. of
Wireless and Mobile Security Workshop, 2005.
[17] L. Hu and D. Evans. Using directional antennas to prevent wormhole
attacks. In Proc. of NDSS, 2004.
[18] Y. Hu, A. Perrig, and D. Johnson. Packet leashes: A defense against
wormhole attacks in wireless ad hoc networks. In Proc. of IEEE IN-
FOCOM, 2003.
[19] X. Ji and H. Zha. Sensor positioning in wireless ad-hoc sensor net-
works with multidimensional scaling. In Proc. of INFOCOM, 2004.
[20] A. Komlodi, P. Rheingans, U. Ayachit, J. Goodall, and A. Joshi. A
user-centered look at glyph-based security visualization. In Proc. of
VizSEC, 2005.
[21] J. Kong, Z. Ji, W. Wang, M. Gerla, R. Bagrodia, and B. Bhargava.
Low-cost attacks against packet delivery, localization and time syn-
chronization services in under-water sensor networks. In Proceedings
of ACM Wireless Security (WiSe), pages 87–96, 2005.
[22] A. Ladd, K. Bekris, A. Rudys, G. Marceau, L. Kavraki, and D. Wal-
lach. Robotics-based location sensing using wireless Ethernet. In
Proceedings of ACM MobiCom, 2002.
[23] K. Lakkaraju, W. Yurcik, A. Lee, R. Bearavolu, Y. Li, and X. Yin. Nvi-
sionip: Netflow visualizations of system state for security situational
awareness. In Proceedings of ACM VizSEC/DMSEC, 2004.
[24] Y. Livnat, J. Agutter, S. Moon, R. Erbacher, and S. Foresti. A visu-
alization paradigm for network intrusion detection. In Proceedings of
the IEEE Information Asssurance Workshop, pages 92–99, 2005.
[25] J. McPherson, K. Ma, P. Krystosk, T. Bartoletti, and M. Christensen.
Portvis: A tool for port-based detection of security events. In Proc. of
ACM VizSEC/DMSEC, 2004.
[26] A. Morrison, G. Ross, and M. Chalmers. A hybrid layout algorithm
for subquadratic multidimensional scaling. In Proc. IEEE Symposium
on Information Visualization, pages 152–158, 2002.
[27] E. P. Mu¨cke. A robust implementation for three-dimensional delaunay
triangulations. In Proceedings of the 1st International Computational
Geometry Software Workshop, pages 70–73, 1995.
[28] C. Muelder, K. Ma, and T. Bartoletti. A visualization methodology
for characterization of network scans. In Proc. of VizSEC, 2005.
[29] D. Niculescu and B. Nath. Ad hoc positioning system (APS) using
AoA. In Proceedings of IEEE INFOCOM, 2003.
[30] P. Papadimitratos and Z. Haas. Secure routing for mobile Ad Hoc
networks. In Proc. of SCS CNDS, 2002.
[31] R. Poovendran and L. Lazos. A graph theoretic framework for pre-
venting the wormhole attack in wireless ad hoc networks. accepted to
appear in ACM Journal on Wireless Networks (WINET), 2006.
[32] N. Priyantha, A. Chakraborty, and H. Padmanabhan. The cricket loca-
tion support system. In Proc. of ACM MobiCom, pages 32–43, 2000.
[33] D. Rafiei and S. Curial. Effectively visualizing large networks through
sampling. In Proc. of IEEE Visualization, 2005.
[34] A. Rao, S. Ratnasamy, C. Papadimitriou, S. Shenker, and I. Stoica. Ge-
ographic routing without location information. pages 96–108, 2003.
[35] P. Ren, Y. Gao, Z. Li, Y. Chen, and B. Watson. IDGraphs: Intrusion
detection and analysis using histographs. In Proc. of VizSEC, 2005.
[36] A. Savvides, C. Han, and M. Srivastava. Dynamic fine-grained local-
ization in ad-hoc networks of sensors. In Proc. of MobiCom, 2001.
[37] Y. Shang, W. Ruml, Y. Zhang, and M. Fromherz. Localization from
mere connectivity. In Proceedings of ACM MobiHoc, 2003.
[38] W. Torgeson. Multidimensional scaling of similarity. Psychometrika,
30:379–393, 1965.
[39] W. Wang and B. Bhargava. Visualization of wormhole attacks in sen-
sor networks. In Proc. of ACM Workshop on Wireless Security, 2004.
[40] M. Williams and T. Munzner. Steerable, progressive multidimensional
scaling. In Proceedings of InfoVis, 2004.
[41] W. Yurcik. VisFlowConnect-IP: A link-based visualization of net-
flows for security monitoring. In 18th Annual FIRST Conference on
Computer Security Incident Handling, 2006.
[42] Y. Zhang and W. Lee. Intrusion detection in wireless ad-hoc networks.
In Proc. of ACM MobiCom, pages 275–283, 2000.
[43] Y. Zhang, W. Lee, and Y. Huang. Intrusion detection techniques for
mobile wireless networks. Wireless Networks Journal, 9(5), 2003.

